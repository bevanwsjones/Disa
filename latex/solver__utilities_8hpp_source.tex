\hypertarget{solver__utilities_8hpp_source}{}\doxysection{solver\+\_\+utilities.\+hpp}
\label{solver__utilities_8hpp_source}\index{libs/solver/solver\_utilities.hpp@{libs/solver/solver\_utilities.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{// MIT License}}
\DoxyCodeLine{3 \textcolor{comment}{// Copyright (c) 2022 Bevan W.S. Jones}}
\DoxyCodeLine{4 \textcolor{comment}{//}}
\DoxyCodeLine{5 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated}}
\DoxyCodeLine{6 \textcolor{comment}{// documentation files (the "{}Software"{}), to deal in the Software without restriction, including without limitation the}}
\DoxyCodeLine{7 \textcolor{comment}{// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to}}
\DoxyCodeLine{8 \textcolor{comment}{// permit persons to whom the Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{9 \textcolor{comment}{//}}
\DoxyCodeLine{10 \textcolor{comment}{// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the}}
\DoxyCodeLine{11 \textcolor{comment}{// Software.}}
\DoxyCodeLine{12 \textcolor{comment}{//}}
\DoxyCodeLine{13 \textcolor{comment}{// THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE}}
\DoxyCodeLine{14 \textcolor{comment}{// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR}}
\DoxyCodeLine{15 \textcolor{comment}{// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{16 \textcolor{comment}{// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{17 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{18 \textcolor{comment}{// File Name: solver\_utilities.hpp}}
\DoxyCodeLine{19 \textcolor{comment}{// Description: Contains the definitions of the template functions for solver utility functions.}}
\DoxyCodeLine{20 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{namespace }Disa \{}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{25 \textcolor{comment}{// Convergence Tracking}}
\DoxyCodeLine{26 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{27 }
\DoxyCodeLine{33 \textcolor{keyword}{template}<\textcolor{keyword}{class} \_matrix, \textcolor{keyword}{class} \_vector>}
\DoxyCodeLine{34 \textcolor{keywordtype}{void} \mbox{\hyperlink{structDisa_1_1Convergence__Data_a304464209574de33a58f913ac0c63e98}{Convergence\_Data::update}}(\textcolor{keyword}{const} \_matrix\& coef, \textcolor{keyword}{const} \_vector\& solution, \textcolor{keyword}{const} \_vector\& constant) \{}
\DoxyCodeLine{35 }
\DoxyCodeLine{36   std::tie(\mbox{\hyperlink{structDisa_1_1Convergence__Data_aec9e5851bec19408cd0079250c09cc26}{residual}}, \mbox{\hyperlink{structDisa_1_1Convergence__Data_af9ef4a3f1d8f63e8b2dd6c373c07d5f9}{residual\_max}}) = compute\_residual(coef, solution, constant);}
\DoxyCodeLine{37 }
\DoxyCodeLine{38   \textcolor{keywordflow}{if}(!\mbox{\hyperlink{structDisa_1_1Convergence__Data_a798c863e81503627ea641eb011d66240}{iteration}}) \{}
\DoxyCodeLine{39     \mbox{\hyperlink{structDisa_1_1Convergence__Data_afb72d30b5e616e7c69330536e0ccd323}{residual\_0}} = \mbox{\hyperlink{structDisa_1_1Convergence__Data_aec9e5851bec19408cd0079250c09cc26}{residual}};}
\DoxyCodeLine{40     \mbox{\hyperlink{structDisa_1_1Convergence__Data_a345f281a6bdd28f1d1695e747f0c616a}{residual\_max\_0}} = \mbox{\hyperlink{structDisa_1_1Convergence__Data_af9ef4a3f1d8f63e8b2dd6c373c07d5f9}{residual\_max}};}
\DoxyCodeLine{41   \}}
\DoxyCodeLine{42   \mbox{\hyperlink{structDisa_1_1Convergence__Data_a4bc9df68fc8876eb1bacb8d2be901756}{residual\_normalised}} = \mbox{\hyperlink{structDisa_1_1Convergence__Data_aec9e5851bec19408cd0079250c09cc26}{residual}}/\mbox{\hyperlink{structDisa_1_1Convergence__Data_afb72d30b5e616e7c69330536e0ccd323}{residual\_0}};}
\DoxyCodeLine{43   \mbox{\hyperlink{structDisa_1_1Convergence__Data_a915dcb3cab85336f35b6793b7e9bc9ba}{residual\_max\_normalised}} = \mbox{\hyperlink{structDisa_1_1Convergence__Data_af9ef4a3f1d8f63e8b2dd6c373c07d5f9}{residual\_max}}/\mbox{\hyperlink{structDisa_1_1Convergence__Data_a345f281a6bdd28f1d1695e747f0c616a}{residual\_max\_0}};}
\DoxyCodeLine{44 }
\DoxyCodeLine{45   ++\mbox{\hyperlink{structDisa_1_1Convergence__Data_a798c863e81503627ea641eb011d66240}{iteration}};}
\DoxyCodeLine{46   \mbox{\hyperlink{structDisa_1_1Convergence__Data_a4f7f81998bd5025c28047f48a15a3171}{duration}} = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::steady\_clock::now() -\/ \mbox{\hyperlink{structDisa_1_1Convergence__Data_ac8f96574eb15a045993a6bd7e5cb8353}{start\_time}});}
\DoxyCodeLine{47 \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{71 \textcolor{keyword}{template}<\textcolor{keyword}{class} \_matrix, \textcolor{keyword}{class} \_vector>}
\DoxyCodeLine{72 std::pair<Scalar, Scalar> compute\_residual(\textcolor{keyword}{const} \_matrix\& coef, \textcolor{keyword}{const} \_vector\& solution, \textcolor{keyword}{const} \_vector\& constant) \{}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{comment}{// Check sizes}}
\DoxyCodeLine{75   ASSERT\_DEBUG(solution.size() != 0 \&\& constant.size() != 0 , \textcolor{stringliteral}{"{}System size is 0."{}});}
\DoxyCodeLine{76   ASSERT\_DEBUG(coef.size\_row() == solution.size(),}
\DoxyCodeLine{77                \textcolor{stringliteral}{"{}Coefficient matrix row size incompatible with solution vector size."{}});}
\DoxyCodeLine{78   ASSERT\_DEBUG(coef.size\_column() == constant.size(),}
\DoxyCodeLine{79                \textcolor{stringliteral}{"{}Coefficient matrix column size incompatible with constant vector size."{}});}
\DoxyCodeLine{80 }
\DoxyCodeLine{81   Scalar l2\_norm = 0.0;}
\DoxyCodeLine{82   Scalar linf\_norm = 0.0;}
\DoxyCodeLine{83   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i\_row = 0; i\_row < coef.size\_row(); ++i\_row) \{}
\DoxyCodeLine{84     Scalar matrix\_vector\_row = 0;}
\DoxyCodeLine{85     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} column\_iter = coef[i\_row].cbegin(); column\_iter != coef[i\_row].cend(); ++column\_iter)}
\DoxyCodeLine{86       matrix\_vector\_row += *column\_iter*solution[column\_iter.i\_column()];}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{comment}{// Compute the l2\_norm and l\_inf norm.}}
\DoxyCodeLine{89     \textcolor{keyword}{const} Scalar\& row\_residual\_squared = std::pow(matrix\_vector\_row -\/ constant[i\_row], 2);}
\DoxyCodeLine{90     l2\_norm += row\_residual\_squared;}
\DoxyCodeLine{91     linf\_norm = std::max(linf\_norm, row\_residual\_squared);}
\DoxyCodeLine{92   \}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94   \textcolor{comment}{// 'Weight' the l\_2 norm and return both norms.}}
\DoxyCodeLine{95   \textcolor{keywordflow}{return} \{std::sqrt(l2\_norm/\textcolor{keyword}{static\_cast<}Scalar\textcolor{keyword}{>}(solution.size())), std::sqrt(linf\_norm)\};}
\DoxyCodeLine{96 \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \}}

\end{DoxyCode}
