\hypertarget{adjacency__graph_8hpp_source}{}\doxysection{adjacency\+\_\+graph.\+hpp}
\label{adjacency__graph_8hpp_source}\index{libs/graphing/adjacency\_graph.hpp@{libs/graphing/adjacency\_graph.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{// MIT License}}
\DoxyCodeLine{3 \textcolor{comment}{// Copyright (c) 2022 Bevan W.S. Jones}}
\DoxyCodeLine{4 \textcolor{comment}{//}}
\DoxyCodeLine{5 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated}}
\DoxyCodeLine{6 \textcolor{comment}{// documentation files (the "{}Software"{}), to deal in the Software without restriction, including without limitation the}}
\DoxyCodeLine{7 \textcolor{comment}{// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to}}
\DoxyCodeLine{8 \textcolor{comment}{// permit persons to whom the Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{9 \textcolor{comment}{//}}
\DoxyCodeLine{10 \textcolor{comment}{// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the}}
\DoxyCodeLine{11 \textcolor{comment}{// Software.}}
\DoxyCodeLine{12 \textcolor{comment}{//}}
\DoxyCodeLine{13 \textcolor{comment}{// THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE}}
\DoxyCodeLine{14 \textcolor{comment}{// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR}}
\DoxyCodeLine{15 \textcolor{comment}{// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{16 \textcolor{comment}{// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{17 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{18 \textcolor{comment}{//  File Name: adjacency\_graph.hpp}}
\DoxyCodeLine{19 \textcolor{comment}{//  Description: Contains the template definitions of the Adjacency\_Graph Class.}}
\DoxyCodeLine{20 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{23 \textcolor{comment}{// Adjacency\_Graph}}
\DoxyCodeLine{24 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{25 \textcolor{comment}{// Modifiers}}
\DoxyCodeLine{26 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{namespace }Disa \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{36 \textcolor{keyword}{template}<\textcolor{keyword}{class} \_unary\_predicate>}
\DoxyCodeLine{37 \textcolor{keywordtype}{void} \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_aa92d806a5f63b67476df6351b315ad55}{Adjacency\_Graph::erase\_if}}(\_unary\_predicate delete\_vertex) \{}
\DoxyCodeLine{38 }
\DoxyCodeLine{39   std::size\_t removed = 0;}
\DoxyCodeLine{40   std::size\_t i\_vertex = 0;}
\DoxyCodeLine{41   std::vector<bool> adjacency\_delete(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.size(), \textcolor{keyword}{false});}
\DoxyCodeLine{42   std::vector<std::size\_t> new\_indexes(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.size(), std::numeric\_limits<std::size\_t>::max());}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   \textcolor{comment}{// Loop over the data, and determine the new offsets and which entries in vertex\_adjacent\_list need to be removed.}}
\DoxyCodeLine{45   FOR(i\_vertex\_old, \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_af0a99181c595852b84e1d469fa6c3002}{size\_vertex}}()) \{}
\DoxyCodeLine{46     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& adjacency = \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a0f9b52aaaa13a10332d8a82d4b526522}{vertex\_adjacency\_iter}}(i\_vertex\_old);}
\DoxyCodeLine{47     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& begin\_delete = adjacency\_delete.begin() + std::distance(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.begin(), adjacency.first);}
\DoxyCodeLine{48     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& end\_delete = adjacency\_delete.begin() + std::distance(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.begin(), adjacency.second);}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}[i\_vertex\_old] -\/= removed;}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{comment}{// Only remove vertices which will be taken out, and record new indexes.}}
\DoxyCodeLine{53     \textcolor{keywordflow}{if}(!delete\_vertex(i\_vertex\_old)) \{}
\DoxyCodeLine{54       new\_indexes[i\_vertex\_old] = i\_vertex++;}
\DoxyCodeLine{55       removed += std::count\_if(adjacency.first, adjacency.second, delete\_vertex);}
\DoxyCodeLine{56       std::transform(adjacency.first, adjacency.second, begin\_delete, delete\_vertex);}
\DoxyCodeLine{57     \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{// All adjacency entries need to be removed, since the vertex is to be removed.}}
\DoxyCodeLine{58       removed += std::distance(adjacency.first, adjacency.second);}
\DoxyCodeLine{59       std::transform(begin\_delete, end\_delete, begin\_delete, [](\textcolor{keyword}{const} \textcolor{keyword}{auto}) \{ \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \});}
\DoxyCodeLine{60     \}}
\DoxyCodeLine{61   \}}
\DoxyCodeLine{62   \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.back() -\/= removed;}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   \textcolor{comment}{// Erase offset entries for the removed vertices.}}
\DoxyCodeLine{65   i\_vertex = 0;}
\DoxyCodeLine{66   \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.erase(std::remove\_if(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.begin(), \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.end(),}
\DoxyCodeLine{67                               [\&](\textcolor{keyword}{const} \textcolor{keyword}{auto}) \{ return i\_vertex < size\_vertex() ? delete\_vertex(i\_vertex++) : false; \}),}
\DoxyCodeLine{68                \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.end());}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{comment}{// Erase removed vertices from the adjacency lists, and then relabel.}}
\DoxyCodeLine{71   i\_vertex = 0;}
\DoxyCodeLine{72   \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.erase(std::remove\_if(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.begin(), \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.end(),}
\DoxyCodeLine{73                                             [\&](\textcolor{keyword}{const} \textcolor{keyword}{auto}) \{ return adjacency\_delete[i\_vertex++]; \}),}
\DoxyCodeLine{74                              \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.end());}
\DoxyCodeLine{75   std::transform(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.begin(), \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.end(), \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.begin(),}
\DoxyCodeLine{76                  [\&](\textcolor{keyword}{const} \textcolor{keyword}{auto}\& i\_old\_vertex) \{ return new\_indexes[i\_old\_vertex]; \});}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   ASSERT(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.back() == \mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.size(),}
\DoxyCodeLine{79          \textcolor{stringliteral}{"{}Total offsets no longer match vertex size while reducing to subgraph, "{}} + std::to\_string(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_a84695f5669958dc3b2dedcfb01863800}{offset}}.back())}
\DoxyCodeLine{80          + \textcolor{stringliteral}{"{} vs. "{}} + std::to\_string(\mbox{\hyperlink{classDisa_1_1Adjacency__Graph_afd5348b92f357a0c1f7ae242cf0eefdd}{vertex\_adjacent\_list}}.size()) + \textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{81 \};}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \}}

\end{DoxyCode}
