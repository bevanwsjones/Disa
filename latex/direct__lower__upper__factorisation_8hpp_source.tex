\hypertarget{direct__lower__upper__factorisation_8hpp_source}{}\doxysection{direct\+\_\+lower\+\_\+upper\+\_\+factorisation.\+hpp}
\label{direct__lower__upper__factorisation_8hpp_source}\index{libs/solver/direct\_lower\_upper\_factorisation.hpp@{libs/solver/direct\_lower\_upper\_factorisation.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{// MIT License}}
\DoxyCodeLine{3 \textcolor{comment}{// Copyright (c) 2022 Bevan W.S. Jones}}
\DoxyCodeLine{4 \textcolor{comment}{//}}
\DoxyCodeLine{5 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated}}
\DoxyCodeLine{6 \textcolor{comment}{// documentation files (the "{}Software"{}), to deal in the Software without restriction, including without limitation the}}
\DoxyCodeLine{7 \textcolor{comment}{// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to}}
\DoxyCodeLine{8 \textcolor{comment}{// permit persons to whom the Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{9 \textcolor{comment}{//}}
\DoxyCodeLine{10 \textcolor{comment}{// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the}}
\DoxyCodeLine{11 \textcolor{comment}{// Software.}}
\DoxyCodeLine{12 \textcolor{comment}{//}}
\DoxyCodeLine{13 \textcolor{comment}{// THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE}}
\DoxyCodeLine{14 \textcolor{comment}{// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR}}
\DoxyCodeLine{15 \textcolor{comment}{// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{16 \textcolor{comment}{// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{17 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{18 \textcolor{comment}{// File Name: direct\_lower\_upper\_factorisation.hpp}}
\DoxyCodeLine{19 \textcolor{comment}{// Description: Contains the template definitions of the LU(P) methods.}}
\DoxyCodeLine{20 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{namespace }Disa \{}
\DoxyCodeLine{23 }
\DoxyCodeLine{45 \textcolor{keyword}{template}<Solver\_Type \_solver\_type, std::\textcolor{keywordtype}{size\_t} \_size, \textcolor{keywordtype}{bool} \_pivot>}
\DoxyCodeLine{46 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classDisa_1_1Direct__Lower__Upper__Factorisation_a14e91d05154a232286186a263be19d36}{Direct\_Lower\_Upper\_Factorisation<\_solver\_type, \_size, \_pivot>::factorise}}(}
\DoxyCodeLine{47   \textcolor{keyword}{const} \mbox{\hyperlink{structDisa_1_1Matrix__Dense}{Matrix\_Dense<\_size, \_size>}}\& a\_matrix) \{}
\DoxyCodeLine{48   }
\DoxyCodeLine{49   \textcolor{comment}{// Initialise factorisation data.}}
\DoxyCodeLine{50   factorised = \textcolor{keyword}{false};}
\DoxyCodeLine{51   lu\_factorised = a\_matrix;}
\DoxyCodeLine{52   \textcolor{keywordflow}{if}(\_pivot)\{}
\DoxyCodeLine{53     pivots.resize(lu\_factorised.size\_column());}
\DoxyCodeLine{54     std::iota(pivots.begin(), pivots.end(), 0);}
\DoxyCodeLine{55   \}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   \textcolor{comment}{// Factorise A into L and U.}}
\DoxyCodeLine{58   \textcolor{keywordflow}{for}(std::size\_t i\_row = 0; i\_row < lu\_factorised.size\_row(); ++i\_row) \{}
\DoxyCodeLine{59 }
\DoxyCodeLine{60     \textcolor{comment}{// Pivoting}}
\DoxyCodeLine{61     \textcolor{keywordflow}{if}(\_pivot) \{}
\DoxyCodeLine{62       }
\DoxyCodeLine{63       \textcolor{comment}{// Find largest remaining column value to pivot on.}}
\DoxyCodeLine{64       Scalar max = 0.0;}
\DoxyCodeLine{65       std::size\_t i\_max = i\_row;}
\DoxyCodeLine{66       \textcolor{keywordflow}{for}(std::size\_t i\_row\_sweep = i\_row; i\_row\_sweep < lu\_factorised.size\_column(); ++i\_row\_sweep) \{}
\DoxyCodeLine{67         \textcolor{keyword}{const} Scalar absA = std::abs(lu\_factorised[i\_row\_sweep][i\_row]);}
\DoxyCodeLine{68         \textcolor{keywordflow}{if}(is\_nearly\_greater(absA, max)) \{ }
\DoxyCodeLine{69             max = absA;}
\DoxyCodeLine{70             i\_max = i\_row\_sweep;}
\DoxyCodeLine{71         \}}
\DoxyCodeLine{72       \} }
\DoxyCodeLine{73 }
\DoxyCodeLine{74       \textcolor{comment}{// Pivot if larger value found.}}
\DoxyCodeLine{75       \textcolor{keywordflow}{if} (i\_max != i\_row) \{}
\DoxyCodeLine{76           std::swap(pivots[i\_row], pivots[i\_max]);}
\DoxyCodeLine{77           std::swap(lu\_factorised[i\_row], lu\_factorised[i\_max]);}
\DoxyCodeLine{78       \}}
\DoxyCodeLine{79     \}}
\DoxyCodeLine{80     }
\DoxyCodeLine{81     \textcolor{comment}{// Check degeneracy.}}
\DoxyCodeLine{82     \textcolor{keywordflow}{if}(std::abs(lu\_factorised[i\_row][i\_row]) < factorisation\_tolerance) \textcolor{keywordflow}{return} \textcolor{keyword}{false}; }
\DoxyCodeLine{83     }
\DoxyCodeLine{84     \textcolor{comment}{// Decomposition, actual factorisation to compute L and U.}}
\DoxyCodeLine{85     \textcolor{keywordflow}{for}(std::size\_t i\_row\_sweep = i\_row + 1; i\_row\_sweep < lu\_factorised.size\_row(); ++i\_row\_sweep) \{}
\DoxyCodeLine{86         lu\_factorised[i\_row\_sweep][i\_row] /= lu\_factorised[i\_row][i\_row];}
\DoxyCodeLine{87 }
\DoxyCodeLine{88         \textcolor{keywordflow}{for} (std::size\_t i\_column\_sweep = i\_row + 1; i\_column\_sweep < lu\_factorised.size\_column(); ++i\_column\_sweep)}
\DoxyCodeLine{89             lu\_factorised[i\_row\_sweep][i\_column\_sweep] -\/= }
\DoxyCodeLine{90               lu\_factorised[i\_row\_sweep][i\_row] * lu\_factorised[i\_row][i\_column\_sweep];}
\DoxyCodeLine{91     \}}
\DoxyCodeLine{92   \}   }
\DoxyCodeLine{93 }
\DoxyCodeLine{94   factorised = \textcolor{keyword}{true};}
\DoxyCodeLine{95   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{96 \}}
\DoxyCodeLine{97   }
\DoxyCodeLine{106 \textcolor{keyword}{template}<Solver\_Type \_solver\_type, std::\textcolor{keywordtype}{size\_t} \_size, \textcolor{keywordtype}{bool} \_pivot>}
\DoxyCodeLine{107 \mbox{\hyperlink{structDisa_1_1Convergence__Data}{Convergence\_Data}} \mbox{\hyperlink{classDisa_1_1Direct__Lower__Upper__Factorisation_a4714f7fee084d09a20d6212bc74d56b8}{Direct\_Lower\_Upper\_Factorisation<\_solver\_type, \_size, \_pivot>::solve\_system}}(}
\DoxyCodeLine{108   \mbox{\hyperlink{structDisa_1_1Vector__Dense}{Vector\_Dense<\_size>}}\& x\_vector, \textcolor{keyword}{const} \mbox{\hyperlink{structDisa_1_1Vector__Dense}{Vector\_Dense<\_size>}}\& b\_vector) \{}
\DoxyCodeLine{109 }
\DoxyCodeLine{110   ASSERT\_DEBUG(b\_vector.size() == lu\_factorised.size\_row(), \textcolor{stringliteral}{"{}Constant vector not of the correct size."{}});}
\DoxyCodeLine{111   }
\DoxyCodeLine{112   \mbox{\hyperlink{structDisa_1_1Convergence__Data}{Convergence\_Data}} convergence\_data = \mbox{\hyperlink{structDisa_1_1Convergence__Data}{Convergence\_Data}}();}
\DoxyCodeLine{113   \textcolor{keywordflow}{if}(!factorised) \textcolor{keywordflow}{return} convergence\_data;}
\DoxyCodeLine{114 }
\DoxyCodeLine{115   ++convergence\_data.\mbox{\hyperlink{structDisa_1_1Convergence__Data_a798c863e81503627ea641eb011d66240}{iteration}};}
\DoxyCodeLine{116   x\_vector.resize(b\_vector.size());}
\DoxyCodeLine{117   \textcolor{keywordflow}{for}(std::size\_t i\_row = 0; i\_row < lu\_factorised.size\_row(); ++i\_row) \{}
\DoxyCodeLine{118         x\_vector[i\_row] = b\_vector[\_pivot ? pivots[i\_row] : i\_row];}
\DoxyCodeLine{119   }
\DoxyCodeLine{120         \textcolor{keywordflow}{for}(std::size\_t i\_column = 0; i\_column < i\_row; ++i\_column)}
\DoxyCodeLine{121             x\_vector[i\_row] -\/= lu\_factorised[i\_row][i\_column] * x\_vector[i\_column];}
\DoxyCodeLine{122     \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{keywordflow}{for}(std::size\_t i\_row = lu\_factorised.size\_row() -\/ 1; i\_row != std::numeric\_limits<std::size\_t>::max(); -\/-\/i\_row) \{}
\DoxyCodeLine{125         \textcolor{keywordflow}{for}(std::size\_t i\_column = i\_row + 1; i\_column < lu\_factorised.size\_column(); ++i\_column)}
\DoxyCodeLine{126             x\_vector[i\_row] -\/= lu\_factorised[i\_row][i\_column] * x\_vector[i\_column];}
\DoxyCodeLine{127         x\_vector[i\_row] /= lu\_factorised[i\_row][i\_row];}
\DoxyCodeLine{128     \}}
\DoxyCodeLine{129   }
\DoxyCodeLine{130   convergence\_data.\mbox{\hyperlink{structDisa_1_1Convergence__Data_af03aba8ebd023253df2e97046a8852c0}{converged}} = \textcolor{keyword}{true};}
\DoxyCodeLine{131   \textcolor{keywordflow}{return} convergence\_data;}
\DoxyCodeLine{132 \}}
\DoxyCodeLine{133   }
\DoxyCodeLine{134 \} \textcolor{comment}{//Disa}}

\end{DoxyCode}
