\hypertarget{laplace__2d_8h_source}{}\doxysection{laplace\+\_\+2d.\+h}
\label{laplace__2d_8h_source}\index{libs/solver/test/laplace\_2d.h@{libs/solver/test/laplace\_2d.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{// MIT License}}
\DoxyCodeLine{3 \textcolor{comment}{// Copyright (c) 2022 Bevan W.S. Jones}}
\DoxyCodeLine{4 \textcolor{comment}{//}}
\DoxyCodeLine{5 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated}}
\DoxyCodeLine{6 \textcolor{comment}{// documentation files (the "{}Software"{}), to deal in the Software without restriction, including without limitation the}}
\DoxyCodeLine{7 \textcolor{comment}{// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to}}
\DoxyCodeLine{8 \textcolor{comment}{// permit persons to whom the Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{9 \textcolor{comment}{//}}
\DoxyCodeLine{10 \textcolor{comment}{// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the}}
\DoxyCodeLine{11 \textcolor{comment}{// Software.}}
\DoxyCodeLine{12 \textcolor{comment}{//}}
\DoxyCodeLine{13 \textcolor{comment}{// THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE}}
\DoxyCodeLine{14 \textcolor{comment}{// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR}}
\DoxyCodeLine{15 \textcolor{comment}{// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{16 \textcolor{comment}{// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{17 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{18 \textcolor{comment}{// File Name: test\_matrix\_operators.h}}
\DoxyCodeLine{19 \textcolor{comment}{// Description: Unit tests for matrix operations.}}
\DoxyCodeLine{20 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{preprocessor}{\#ifndef DISA\_LAPLACE\_2D\_H}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#define DISA\_LAPLACE\_2D\_H}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}matrix\_dense.h"{}}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}matrix\_sparse.h"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}scalar.h"{}}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}vector\_dense.h"{}}}
\DoxyCodeLine{29 }
\DoxyCodeLine{34 \textcolor{keyword}{class }\mbox{\hyperlink{classLaplace__2D}{Laplace\_2D}} }
\DoxyCodeLine{35 \{}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{keyword}{public}:}
\DoxyCodeLine{38 }
\DoxyCodeLine{62   \textcolor{keyword}{template}<\textcolor{keyword}{class} \_matrix\_type, \textcolor{keyword}{class} \_vector\_type>}
\DoxyCodeLine{63   \textcolor{keywordtype}{void} \mbox{\hyperlink{classLaplace__2D_ac59c4bf18174406ac8b8ae85dac6dca5}{construct\_laplace\_2d}}(\_matrix\_type\& a\_matrix, \_vector\_type\& b\_vector, \_vector\_type\& x\_vector) \{}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     ASSERT\_DEBUG(a\_matrix.size\_row() == a\_matrix.size\_column(), \textcolor{stringliteral}{"{}Matrix must be square."{}});   }
\DoxyCodeLine{66     ASSERT\_DEBUG(a\_matrix.size\_row() == b\_vector.size(), \textcolor{stringliteral}{"{}Matrix-\/vector size mismatch, b-\/vector."{}});}
\DoxyCodeLine{67     ASSERT\_DEBUG(a\_matrix.size\_row() == x\_vector.size(), \textcolor{stringliteral}{"{}Matrix-\/vector size mismatch, x-\/vector."{}});}
\DoxyCodeLine{68     \textcolor{keyword}{const} \textcolor{keywordtype}{int} number\_of\_nodes = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(b\_vector.size());}
\DoxyCodeLine{69     ASSERT\_DEBUG(number\_of\_nodes >= 9, \textcolor{stringliteral}{"{}Must be greater equal than 9."{}});}
\DoxyCodeLine{70     \textcolor{keyword}{const} \textcolor{keywordtype}{int} x\_nodes = sqrt(number\_of\_nodes);}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     a\_matrix *= 0.0;}
\DoxyCodeLine{73     \textcolor{keyword}{const} Disa::Scalar delta\_x = \textcolor{keyword}{static\_cast<}Disa::Scalar\textcolor{keyword}{>}(1.0/(x\_nodes -\/ 1.0));}
\DoxyCodeLine{74     \textcolor{keyword}{const} Disa::Scalar delta\_x\_squared = 1.0/(delta\_x*delta\_x);}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{comment}{// populate}}
\DoxyCodeLine{77     FOR(i\_node, number\_of\_nodes)}
\DoxyCodeLine{78     \{}
\DoxyCodeLine{79       b\_vector[i\_node] = \mbox{\hyperlink{classLaplace__2D_a8a106fd4f816fba2579aa2e3103b769e}{source}}(i\_node, x\_nodes);}
\DoxyCodeLine{80       x\_vector[i\_node] = \mbox{\hyperlink{classLaplace__2D_a9a99c57063fc339ca23491f7acdfc871}{analytical\_solution}}(i\_node, x\_nodes);}
\DoxyCodeLine{81       }
\DoxyCodeLine{82       \textcolor{keywordflow}{if}((i\_node) \% x\_nodes == 0 || (i\_node + 1) \% x\_nodes == 0 || i\_node < x\_nodes || i\_node >= (number\_of\_nodes -\/ x\_nodes)) \{}
\DoxyCodeLine{83         FOR\_EACH\_REF(column, a\_matrix[i\_node]) column = 0.0;}
\DoxyCodeLine{84         a\_matrix[i\_node][i\_node] = 1.0;}
\DoxyCodeLine{85         b\_vector[i\_node] = \mbox{\hyperlink{classLaplace__2D_a9a99c57063fc339ca23491f7acdfc871}{analytical\_solution}}(i\_node, x\_nodes);}
\DoxyCodeLine{86       \}}
\DoxyCodeLine{87       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{88         \textcolor{keywordflow}{if}((i\_node + x\_nodes) < number\_of\_nodes) a\_matrix[i\_node][i\_node + x\_nodes] = -\/1.0*delta\_x\_squared;}
\DoxyCodeLine{89         \textcolor{keywordflow}{if}(i\_node\%x\_nodes != 0) a\_matrix[i\_node][i\_node -\/ 1] = -\/1.0*delta\_x\_squared;}
\DoxyCodeLine{90         a\_matrix[i\_node][i\_node] = 4*delta\_x\_squared;}
\DoxyCodeLine{91         \textcolor{keywordflow}{if}((i\_node + 1)\%x\_nodes != 0) a\_matrix[i\_node][i\_node + 1] = -\/1.0*delta\_x\_squared;}
\DoxyCodeLine{92         \textcolor{keywordflow}{if}((i\_node -\/ x\_nodes) >= 0) a\_matrix[i\_node][i\_node -\/ x\_nodes] = -\/1.0*delta\_x\_squared;}
\DoxyCodeLine{93       \}}
\DoxyCodeLine{94       }
\DoxyCodeLine{95     \}}
\DoxyCodeLine{96   \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98   std::pair<Disa::Scalar, Disa::Scalar> co\_ordinate(\textcolor{keyword}{const} std::size\_t i\_node, \textcolor{keyword}{const} std::size\_t size\_x) \{}
\DoxyCodeLine{99   \textcolor{keyword}{const} Disa::Scalar delta\_x = 1.0/\textcolor{keyword}{static\_cast<}Disa::Scalar\textcolor{keyword}{>}(size\_x -\/ 1.0);}
\DoxyCodeLine{100   \textcolor{keywordflow}{return} \{\textcolor{keyword}{static\_cast<}Disa::Scalar\textcolor{keyword}{>}((i\_node \% size\_x)*delta\_x), }
\DoxyCodeLine{101           \textcolor{keyword}{static\_cast<}Disa::Scalar\textcolor{keyword}{>}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i\_node / size\_x))*delta\_x\};}
\DoxyCodeLine{102   \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104 }
\DoxyCodeLine{111   Disa::Scalar \mbox{\hyperlink{classLaplace__2D_a8a106fd4f816fba2579aa2e3103b769e}{source}}(\textcolor{keyword}{const} std::size\_t i\_node, \textcolor{keyword}{const} std::size\_t size\_x) \{}
\DoxyCodeLine{112     \textcolor{comment}{// -\/2 [(1 -\/ 6x\string^2)y\string^2(y\string^2 -\/ 1) + (6y\string^2 -\/ 1)x\string^2(1 -\/ x\string^2)]}}
\DoxyCodeLine{113     \textcolor{keyword}{const} \textcolor{keyword}{auto} [co\_ordinate\_x, co\_ordinate\_y] = co\_ordinate(i\_node, size\_x);}
\DoxyCodeLine{114     \textcolor{keyword}{const} Disa::Scalar squared\_x = co\_ordinate\_x*co\_ordinate\_x;}
\DoxyCodeLine{115     \textcolor{keyword}{const} Disa::Scalar squared\_y = co\_ordinate\_y*co\_ordinate\_y;}
\DoxyCodeLine{116     \textcolor{keyword}{const} Disa::Scalar value = -\/2.0*((1.0 -\/ 6.0*squared\_x)*squared\_y*(squared\_y -\/ 1.0)}
\DoxyCodeLine{117                                     + (6.0*squared\_y -\/ 1.0)*squared\_x*(1.0 -\/ squared\_x));}
\DoxyCodeLine{118     \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{119   \}}
\DoxyCodeLine{120 }
\DoxyCodeLine{128   Disa::Scalar \mbox{\hyperlink{classLaplace__2D_a9a99c57063fc339ca23491f7acdfc871}{analytical\_solution}}(\textcolor{keyword}{const} std::size\_t i\_node, \textcolor{keyword}{const} std::size\_t size\_x) \{}
\DoxyCodeLine{129     \textcolor{keyword}{const} \textcolor{keyword}{auto} [co\_ordinate\_x, co\_ordinate\_y] = co\_ordinate(i\_node, size\_x);}
\DoxyCodeLine{130     \textcolor{keyword}{const} Disa::Scalar squared\_x = co\_ordinate\_x*co\_ordinate\_x;}
\DoxyCodeLine{131     \textcolor{keyword}{const} Disa::Scalar squared\_y = co\_ordinate\_y*co\_ordinate\_y;}
\DoxyCodeLine{132     \textcolor{keywordflow}{return} (squared\_x -\/ squared\_x*squared\_x)*(squared\_y*squared\_y -\/ squared\_y);}
\DoxyCodeLine{133   \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \};}
\DoxyCodeLine{136 }
\DoxyCodeLine{137 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//DISA\_LAPLACE\_2D\_H}}

\end{DoxyCode}
